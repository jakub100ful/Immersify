<!DOCTYPE html>
<html lang="en">
  <head>
    <title>My Webpage</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6"
      crossorigin="anonymous"
    />
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-JEW9xMcG8R+pH31jmWH6WWP0WintQrMb4s7ZOdauHnUtxwoG2vI5DkLtS3qm9Ekf"
      crossorigin="anonymous"
    ></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles/styles.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='styles/emotions.css') }}">
  </head>

  <body>
    <div class="container" id="navbar-container">
      <!-- Navigation Bar -->
      <nav class="navbar navbar-expand-lg navbar-dark">
        <h1><a class="navbar-brand" href="#">Immersify</a></h1>
        <button
          class="navbar-toggler"
          type="button"
          data-toggle="collapse"
          data-target="#navbarNav"
          aria-controls="navbarNav"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav">
            <li class="nav-item active">
              <a class="nav-link" href="#">Home</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#">Saved</a>
            </li>
          </ul>
        </div>
      </nav>
    </div>
    <div class="card" id="video-card">
      <div class="card-body" id="body">
      <!-- Video -->

      {% set vid_file_path = video_id+"/"+video_id+"_video.mp4" %}
      {% set sub_file_path = video_id+"/"+video_id+"_emotive_subtitles.vtt" %}
        <video id="video" controls preload="metadata">
          <source
            src="{{ url_for('static', filename='videos/' ~ vid_file_path) | safe }}"
            type="video/mp4"
          />
          <track
            label="English"
            kind="subtitles"
            srclang="en"
            src="{{ url_for('static', filename='videos/' ~ sub_file_path) | safe }}"
            default
          />

          <div id="video-controls" class="controls" data-state="hidden">
            <button id="playpause" type="button" data-state="play">
              Play/Pause
            </button>
            <button id="stop" type="button" data-state="stop">Stop</button>
            <div class="progress">
              <progress id="progress" value="0" min="0">
                <span id="progress-bar"></span>
              </progress>
            </div>
            <button id="mute" type="button" data-state="mute">Mute/Unmute</button>
            <button id="volinc" type="button" data-state="volup">Vol+</button>
            <button id="voldec" type="button" data-state="voldown">Vol-</button>
            <button id="fs" type="button" data-state="go-fullscreen">
              Fullscreen
            </button>
            <button id="subtitles" type="button" data-state="subtitles">
              CC
            </button>
          </div>
        </video>
        <!-- Subtitle -->
        <div id="display">
        </div>
      </div>
    </div>
    <div id="accordion">
      <div class="card">
        <div class="card-header" id="headingOne">
          <h5 class="mb-0">
            <button class="btn btn-link" data-toggle="collapse" data-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
              <div class="h4 d-flex">
                <div>Screenshots</div>
                <i class="bi bi-caret-down-fill ml-1"></i>
              </div>
            </button>
          </h5>
        </div>
        </div>

        <div id="collapseOne" class="collapse" aria-labelledby="headingOne" data-parent="#accordion">   
          <button>Toggle</button>
          
        </div>
    </div>

      <script>
        for (var i = 0; i < video.textTracks.length; i++) {
          video.textTracks[i].mode = 'hidden';
        }

        tracks = document.querySelector('video').textTracks;
        track = tracks[0];
        track.addEventListener('cuechange', function () {
          let cues = track.activeCues;  // array of current cues
          if (cues.length != 0){
            document.getElementById("display").innerHTML = cues[0].text;
          }else{
            document.getElementById("display").innerHTML = "";
          }
        });
      </script>
    </div>
  </body>
</html>
